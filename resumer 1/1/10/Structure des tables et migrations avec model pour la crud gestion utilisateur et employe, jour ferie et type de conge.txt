Models employe
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Employe extends Model
{
    use HasFactory;

    protected $primaryKey = 'matricule';
    public $incrementing = false;
    protected $keyType = 'string';
    
    protected $table = 'employes';

    protected $fillable = [
        'matricule',
        'nom',
        'prenom',
        'sexe',
        'fonction',
        'soldeConge',
        'dateEmbauche',
        'idStructure',
        'superieur_id'
    ];

    protected $casts = [
        'dateEmbauche' => 'date',
    ];

    // Relation avec la structure
    public function structure()
    {
        return $this->belongsTo(Structure::class, 'idStructure');
    }

    // Relation avec le supérieur
    public function superieur()
    {
        return $this->belongsTo(Employe::class, 'superieur_id', 'matricule');
    }

    // Relation avec les subordonnés
    public function subordonnes()
    {
        return $this->hasMany(Employe::class, 'superieur_id', 'matricule');
    }

    // Relation avec les demandes de congé
    public function demandesConges()
    {
        return $this->hasMany(DemandeConge::class, 'idEmploye', 'matricule');
    }

    // Relation avec l'utilisateur
    public function user()
    {
        return $this->hasOne(User::class, 'matricule_employe', 'matricule');
    }
}
model structure
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Structure extends Model
{
    use HasFactory;

    protected $primaryKey = 'idStructure';
    
    protected $table = 'structures';

    protected $fillable = [
        'nom',
        'type'
    ];

    // Relation avec les employés
    public function employes()
    {
        return $this->hasMany(Employe::class, 'idStructure');
    }
}
model user
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;
use Laravel\Sanctum\HasApiTokens;

class User extends Authenticatable
{
    use HasApiTokens, HasFactory, Notifiable;

    protected $primaryKey = 'idUtilisateur';
    
    protected $table = 'users';

    protected $fillable = [
        'email',
        'motDePasse',
        'role',
        'matricule_employe'
    ];

    protected $hidden = [
        'motDePasse',
        'remember_token',
    ];

    public function getAuthPassword()
    {
        return $this->motDePasse;
    }

    // Relation avec l'employé
    public function employe()
    {
        return $this->belongsTo(Employe::class, 'matricule_employe', 'matricule');
    }

    // Relation avec l'historique
    public function historiques()
    {
        return $this->hasMany(Historique::class, 'idUtilisateur');
    }
}
Model jour ferier
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class JourFerie extends Model
{
    use HasFactory;

    protected $primaryKey = 'idDate';
    
    protected $table = 'jour_feriers';

    protected $fillable = [
        'date',
        'description'
    ];

    protected $casts = [
        'date' => 'date',
    ];
}
model type conger
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class TypeConge extends Model
{
    use HasFactory;

    protected $primaryKey = 'idType';
    
    protected $table = 'type_conges';

    protected $fillable = [
        'nom',
        'nombreJour'
    ];

    // Relation avec les demandes de congé
    public function demandesConges()
    {
        return $this->hasMany(DemandeConge::class, 'idType');
    }
}
migration user
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    public function up()
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id('idUtilisateur');
            $table->string('email')->unique();
            $table->string('motDePasse');
            $table->enum('role', ['admin', 'rh', 'employe', 'superieur'])->default('employe');
            $table->string('matricule_employe')->nullable()->constrained('employes', 'matricule');
            $table->rememberToken();
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::dropIfExists('users');
    }
};
migrations structure
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    public function up()
    {
        Schema::create('structures', function (Blueprint $table) {
            $table->id('idStructure');
            $table->string('nom');
            $table->enum('type', ['Direction', 'Département', 'Service']);
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::dropIfExists('structures');
    }
};
migrations employe
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    public function up()
    {
        Schema::create('employes', function (Blueprint $table) {
            $table->string('matricule')->primary();
            $table->string('nom');
            $table->string('prenom');
            $table->enum('sexe', ['M', 'F']);
            $table->string('fonction');
            $table->integer('soldeConge')->default(25);
            $table->date('dateEmbauche');
            $table->foreignId('idStructure')->constrained('structures', 'idStructure');
            $table->string('superieur_id')->nullable()->constrained('employes', 'matricule');
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::dropIfExists('employes');
    }
};
migrations type conge
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    public function up()
    {
        Schema::create('type_conges', function (Blueprint $table) {
            $table->id('idType');
            $table->string('nom');
            $table->integer('nombreJour');
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::dropIfExists('type_conges');
    }
};
model jour ferier
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    public function up()
    {
        Schema::create('jour_feriers', function (Blueprint $table) {
            $table->id('idDate');
            $table->date('date');
            $table->string('description');
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::dropIfExists('jour_feriers');
    }
};